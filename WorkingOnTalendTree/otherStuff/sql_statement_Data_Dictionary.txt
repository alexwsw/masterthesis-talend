select 
*
from 
TALEND_TEST.INFORMATION_SCHEMA.COLUMNS a left join 
TALEND_TEST.INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE b on a.TABLE_NAME = b.TABLE_NAME and a.COLUMN_NAME = b.COLUMN_NAME left join 
TALEND_TEST.INFORMATION_SCHEMA.TABLE_CONSTRAINTS c on c.CONSTRAINT_NAME = b.CONSTRAINT_NAME 
where a.TABLE_NAME = 'kinput' 
and 
(c.CONSTRAINT_TYPE = upper('primary key') 
or 
c.CONSTRAINT_NAME is null)


--An Talend's metadata angepasste Anfrage

select 
(case when c.CONSTRAINT_TYPE = upper('primary key') then 'true' else 'false' end) as is_key,
(case when a.CHARACTER_MAXIMUM_LENGTH is null then 10 else a.CHARACTER_MAXIMUM_LENGTH end) as field_length,
null as name,
(case when a.IS_NULLABLE = upper('yes') then 'true' else 'false' end) as is_nullable,
a.COLUMN_NAME as originalDbColumnName,
a.NUMERIC_PRECISION as precision,
upper(a.DATA_TYPE) as sourceType
from 
TALEND_TEST.INFORMATION_SCHEMA.COLUMNS a 
left join 
TALEND_TEST.INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE b 
on 
a.TABLE_NAME = b.TABLE_NAME and a.COLUMN_NAME = b.COLUMN_NAME 
left join 
TALEND_TEST.INFORMATION_SCHEMA.TABLE_CONSTRAINTS c 
on 
c.CONSTRAINT_NAME = b.CONSTRAINT_NAME and b.TABLE_NAME = c.TABLE_NAME
where 
a.TABLE_NAME = 'kinput' 
and 
(c.CONSTRAINT_TYPE = upper('primary key') 
or 
c.CONSTRAINT_NAME is null)

